# ğŸ“Š XCoinPay Data Flow Diagram

## ğŸ”„ Complete Data Flow from Frontend to MongoDB Atlas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND      â”‚    â”‚    BACKEND      â”‚    â”‚  MONGODB ATLAS  â”‚
â”‚   (React App)   â”‚    â”‚  (Node.js API)  â”‚    â”‚  (Cloud DB)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â–¼â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ 1. User â”‚              â”‚ 2. APIâ”‚              â”‚ 3. Data â”‚
    â”‚ Fills   â”‚              â”‚ Route â”‚              â”‚ Storage â”‚
    â”‚ Form    â”‚              â”‚ Logic â”‚              â”‚         â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”¬â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
```

## ğŸ‘¤ User Registration Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER REGISTRATION                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Frontend Form â†’ POST /api/register â†’ Backend Processing â†’ MongoDB Atlas

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚    â”‚   API       â”‚    â”‚  Password   â”‚    â”‚   Users     â”‚
â”‚   Input:    â”‚â”€â”€â”€â–¶â”‚   Route:    â”‚â”€â”€â”€â–¶â”‚   Hashing   â”‚â”€â”€â”€â–¶â”‚ Collection  â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ â€¢ name      â”‚    â”‚ /api/       â”‚    â”‚ bcrypt.hash â”‚    â”‚ Document:   â”‚
â”‚ â€¢ email     â”‚    â”‚ register    â”‚    â”‚ (password,  â”‚    â”‚ {           â”‚
â”‚ â€¢ password  â”‚    â”‚             â”‚    â”‚  12 rounds) â”‚    â”‚   _id: ...  â”‚
â”‚ â€¢ kycData   â”‚    â”‚             â”‚    â”‚             â”‚    â”‚   name: ... â”‚
â”‚   (optional)â”‚    â”‚             â”‚    â”‚             â”‚    â”‚   email: ...â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   password: â”‚
                                                         â”‚   hash      â”‚
                                                         â”‚   kycData:  â”‚
                                                         â”‚   {...}     â”‚
                                                         â”‚   kycStatus:â”‚
                                                         â”‚   "pending" â”‚
                                                         â”‚ }           â”‚
                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” User Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USER LOGIN                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Frontend Form â†’ POST /api/login â†’ Backend Processing â†’ JWT Token

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚    â”‚   API       â”‚    â”‚  Password   â”‚    â”‚   JWT       â”‚
â”‚   Input:    â”‚â”€â”€â”€â–¶â”‚   Route:    â”‚â”€â”€â”€â–¶â”‚   Verify    â”‚â”€â”€â”€â–¶â”‚   Token     â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ â€¢ email     â”‚    â”‚ /api/       â”‚    â”‚ bcrypt.     â”‚    â”‚ {           â”‚
â”‚ â€¢ password  â”‚    â”‚ login       â”‚    â”‚ compare()   â”‚    â”‚   userId:   â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚   email:    â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚   exp: 24h  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ }           â”‚
                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ KYC Form Submission Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KYC SUBMISSION                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Frontend Form â†’ POST /api/kyc â†’ Backend Processing â†’ MongoDB Atlas

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   KYC       â”‚    â”‚   API       â”‚    â”‚   JWT       â”‚    â”‚   Users     â”‚
â”‚   Data:     â”‚â”€â”€â”€â–¶â”‚   Route:    â”‚â”€â”€â”€â–¶â”‚   Verify    â”‚â”€â”€â”€â–¶â”‚ Collection  â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ â€¢ fullName  â”‚    â”‚ /api/kyc    â”‚    â”‚ jwt.verify  â”‚    â”‚ Update:     â”‚
â”‚ â€¢ dateOfBirthâ”‚   â”‚             â”‚    â”‚ (token)     â”‚    â”‚ {           â”‚
â”‚ â€¢ nationalityâ”‚   â”‚             â”‚    â”‚             â”‚    â”‚   kycData:  â”‚
â”‚ â€¢ passportId â”‚   â”‚             â”‚    â”‚             â”‚    â”‚   {...}     â”‚
â”‚ â€¢ country   â”‚    â”‚             â”‚    â”‚             â”‚    â”‚   kycStatus:â”‚
â”‚ â€¢ address   â”‚    â”‚             â”‚    â”‚             â”‚    â”‚   "pending" â”‚
â”‚ â€¢ city      â”‚    â”‚             â”‚    â”‚             â”‚    â”‚ }           â”‚
â”‚ â€¢ postalCodeâ”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’° Transaction Storage Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  TRANSACTION STORAGE                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Frontend Form â†’ POST /api/transactions â†’ Backend Processing â†’ MongoDB Atlas

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Transaction â”‚    â”‚   API       â”‚    â”‚   JWT       â”‚    â”‚Transactionsâ”‚
â”‚   Data:     â”‚â”€â”€â”€â–¶â”‚   Route:    â”‚â”€â”€â”€â–¶â”‚   Verify    â”‚â”€â”€â”€â–¶â”‚ Collection  â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ â€¢ amount    â”‚    â”‚ /api/       â”‚    â”‚ jwt.verify  â”‚    â”‚ Document:   â”‚
â”‚ â€¢ tokens    â”‚    â”‚ transactionsâ”‚    â”‚ (token)     â”‚    â”‚ {           â”‚
â”‚ â€¢ bonusTokensâ”‚   â”‚             â”‚    â”‚             â”‚    â”‚   _id: ...  â”‚
â”‚ â€¢ totalTokensâ”‚   â”‚             â”‚    â”‚             â”‚    â”‚   userId:   â”‚
â”‚ â€¢ txHash    â”‚    â”‚             â”‚    â”‚             â”‚    â”‚   amount:   â”‚
â”‚ â€¢ walletAddrâ”‚    â”‚             â”‚    â”‚             â”‚    â”‚   tokens:   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   txHash:   â”‚
                                                         â”‚   status:   â”‚
                                                         â”‚   "completed"â”‚
                                                         â”‚   createdAt:â”‚
                                                         â”‚ }           â”‚
                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ KYC Approval/Rejection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                KYC APPROVAL/REJECTION                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Email Link â†’ GET /api/kyc/approve â†’ Backend Processing â†’ MongoDB Atlas

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Owner     â”‚    â”‚   API       â”‚    â”‚   Find      â”‚    â”‚   Users     â”‚
â”‚   Clicks    â”‚â”€â”€â”€â–¶â”‚   Route:    â”‚â”€â”€â”€â–¶â”‚   User      â”‚â”€â”€â”€â–¶â”‚ Collection  â”‚
â”‚   Link      â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚             â”‚    â”‚ /api/kyc/   â”‚    â”‚ User.       â”‚    â”‚ Update:     â”‚
â”‚ â€¢ Approve   â”‚    â”‚ approve     â”‚    â”‚ findById()  â”‚    â”‚ {           â”‚
â”‚ â€¢ Reject    â”‚    â”‚ /api/kyc/   â”‚    â”‚             â”‚    â”‚   kycStatus:â”‚
â”‚             â”‚    â”‚ reject      â”‚    â”‚             â”‚    â”‚   "approved"â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚   kycCompleted:â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   true     â”‚
                                                         â”‚ }           â”‚
                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Database Collections Structure

```
MongoDB Atlas Database: "xcoinpay"
â”œâ”€â”€ Collection: "users"
â”‚   â”œâ”€â”€ Document 1: {
â”‚   â”‚     _id: ObjectId("..."),
â”‚   â”‚     name: "John Doe",
â”‚   â”‚     email: "john@example.com",
â”‚   â”‚     password: "$2a$12$...", // hashed
â”‚   â”‚     kycData: {
â”‚   â”‚       fullName: "John Doe",
â”‚   â”‚       dateOfBirth: "1990-01-01",
â”‚   â”‚       nationality: "US",
â”‚   â”‚       passportId: "A1234567",
â”‚   â”‚       country: "United States",
â”‚   â”‚       address: "123 Main St",
â”‚   â”‚       city: "New York",
â”‚   â”‚       postalCode: "10001"
â”‚   â”‚     },
â”‚   â”‚     kycStatus: "approved",
â”‚   â”‚     kycCompleted: true,
â”‚   â”‚     walletAddress: "0x...",
â”‚   â”‚     createdAt: "2024-01-15T10:30:00Z"
â”‚   â”‚   }
â”‚   â””â”€â”€ Document 2: { ... }
â”‚
â””â”€â”€ Collection: "transactions"
    â”œâ”€â”€ Document 1: {
    â”‚     _id: ObjectId("..."),
    â”‚     userId: ObjectId("..."), // references users._id
    â”‚     amount: 100,
    â”‚     tokens: 1000,
    â”‚     bonusTokens: 100,
    â”‚     totalTokens: 1100,
    â”‚     txHash: "0x1234567890abcdef...",
    â”‚     status: "completed",
    â”‚     walletAddress: "0x...",
    â”‚     createdAt: "2024-01-15T11:00:00Z"
    â”‚   }
    â””â”€â”€ Document 2: { ... }
```

## ğŸ” Security Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SECURITY LAYERS                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend  â”‚    â”‚   Backend   â”‚    â”‚   MongoDB   â”‚    â”‚   Atlas     â”‚
â”‚             â”‚    â”‚             â”‚    â”‚   Atlas     â”‚    â”‚   Security  â”‚
â”‚ â€¢ Input     â”‚    â”‚ â€¢ JWT       â”‚    â”‚ â€¢ Data      â”‚    â”‚ â€¢ Network   â”‚
â”‚   Validationâ”‚    â”‚   Tokens    â”‚    â”‚   Encryptionâ”‚    â”‚   Access    â”‚
â”‚ â€¢ HTTPS     â”‚    â”‚ â€¢ Password  â”‚    â”‚ â€¢ Backup    â”‚    â”‚ â€¢ Firewall  â”‚
â”‚   Requests  â”‚    â”‚   Hashing   â”‚    â”‚ â€¢ Monitoringâ”‚    â”‚ â€¢ SSL/TLS   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ Data Flow Summary

```
1. User fills form on frontend
   â†“
2. Frontend sends HTTP request to backend API
   â†“
3. Backend validates data and processes request
   â†“
4. Backend connects to MongoDB Atlas
   â†“
5. Data is stored/updated in cloud database
   â†“
6. Backend sends response back to frontend
   â†“
7. Frontend updates UI based on response
```

---

**This is how your XCoinPay app securely stores all data in MongoDB Atlas! ğŸš€**
